<form class="form" role="form" [formGroup]="form" (ngSubmit)="onSubmit()">
  <fieldset>
    <div class="row " id="outer">
      <div *ngIf="!btnSave" id="inner" class="col-lg-6">
        <nb-card>
          <nb-card-header>Customer Information </nb-card-header>

          <nb-card-body>

            <div class="form-group">
              <label class="mr-3">Customer</label>
              <div class="">

                <input (click)="showDrop()" type="text" placeholder="Search" class="form-control" formControlName="search" [(ngModel)]="search"
                />

                <select *ngIf="search&&showDropdown" size="4" [(ngModel)]="selectedCustomer" (change)="customerChange()" class="form-control"
                  [formControl]="form.controls['customer']" [ngClass]="{'form-control-danger': form.controls['customer'].hasError('required') && form.controls['customer'].touched}">
                  <option (click)="hideDrop()" *ngFor="let c of customerList | searchPipe:search" [ngValue]="c">{{c.first_name}} | {{c.cnic}} | {{c.mobile}}</option>
                </select>
                <div style="color:red" class="m-1 form-control-feedback" *ngIf="form.controls['customer'].hasError('required') && form.controls['customer'].touched">Dealer is required.</div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-6  form-group">
                <label>First Name</label>
                <input readonly type="text" [disabled]="true" id="normal-field" placeholder="First Name" class="form-control" [formControl]="form.controls['first_name']"
                  [ngClass]="{'form-control-danger': form.controls['first_name'].hasError('required') && form.controls['first_name'].touched}"
                />
              </div>
              <div class="col-sm-6  form-group">
                <label>Last Name</label>
                <input readonly type="text" [disabled]="true" placeholder="Last Name" class="form-control" [formControl]="form.controls['last_name']"
                  [ngClass]="{'form-control-danger': form.controls['last_name'].hasError('required') && form.controls['last_name'].touched}"
                />
              </div>
            </div>
            <div class=" form-group">
              <label>Email</label>
              <input readonly type="email" [disabled]="true" placeholder="Email" class="form-control" [formControl]="form.controls['email']"
                [ngClass]="{'form-control-danger': form.controls['email'].hasError('required') && form.controls['email'].touched}">
            </div>
            <!-- <div class=" form-group" *ngIf="!btnSave">
                          <input type="password" placeholder="Password" class="form-control" [formControl]="form.controls['password']" [ngClass]="{'form-control-danger': form.controls['password'].hasError('required') && form.controls['password'].touched}">
                          <div style="color:red" class="m-1 form-control-feedback" *ngIf="form.controls['password'].hasError('required')  && form.controls['password'].touched">password is required.</div>
                      </div> -->
            <div class=" form-group">
              <label>CNIC</label>
              <!-- <input type="number" placeholder="CNIC Number" class="form-control"/> -->
              <input readonly type="text" [disabled]="true" placeholder="CNIC Number" class="form-control" [formControl]="form.controls['cnic']"
                [ngClass]="{'form-control-danger': form.controls['cnic'].hasError('required')  && form.controls['cnic'].touched}"
              />
            </div>

            <div class="form-group">
              <label>Mobile Number</label>
              <input readonly type="text" [disabled]="true" placeholder="Mobile Number" class="form-control" [formControl]="form.controls['mobile']"
                [ngClass]="{'form-control-danger': form.controls['mobile'].hasError('required') && form.controls['mobile'].touched}">
            </div>






          </nb-card-body>
        </nb-card>

        <nb-card>
          <nb-card-header>Address Info</nb-card-header>
          <nb-card-body>


            <div class=" form-group">
              <label>Connection Address</label>
              <textarea rows="4" placeholder="Connection Address" class="form-control" [formControl]="form.controls['address']" [ngClass]="{'form-control-danger': form.controls['address'].hasError('required') && form.controls['address'].touched}"></textarea>
              <div style="color:red" class="m-1 form-control-feedback" *ngIf="form.controls['address'].hasError('required') && form.controls['address'].touched">address is required.</div>
            </div>



          </nb-card-body>
        </nb-card>
      </div>
      <div class="col-lg-6">

        <nb-card>
          <nb-card-header>Connection Info
            <span (click)="enableEdit()" *ngIf="editable" class="updateIcon">
              <i class="nb-edit"></i>

            </span>
            <span (click)="disableEdit()" *ngIf="!editable&&dataLoaded" class="updateIcon">

              <i class="nb-close"></i>
            </span>
          </nb-card-header>
          <nb-card-body>
            <div class="form-group">
              <label>Username</label>
              <input type="text" placeholder="Username" class="form-control" [formControl]="form.controls['username']" [ngClass]="{'form-control-danger': form.controls['username'].hasError('required')  && form.controls['username'].touched}"
              />
              <div style="color:red" class="m-1 form-control-feedback" *ngIf="form.controls['username'].hasError('required') && form.controls['username'].touched">username is required.</div>


            </div>
            <div class="form-group">
              <label>Password</label>
              <input type="password" placeholder="Password" class="form-control" [formControl]="form.controls['password']" [ngClass]="{'form-control-danger': !btnSave &&form.controls['password'].hasError('required')  && form.controls['password'].touched}"
              />
              <div style="color:red" class="m-1 form-control-feedback" *ngIf="!btnSave &&form.controls['password'].hasError('required') && form.controls['password'].touched">password is required.</div>


            </div>
            <div class="form-group">
              <label>Packages</label>
              <select [(ngModel)]="selectedPackage" class="form-control" [formControl]="form.controls['package']" [ngClass]="{'form-control-danger': form.controls['package'].hasError('required') && form.controls['package'].touched}">
                <option *ngFor="let p of packageList" [ngValue]="p">{{p.package_name}}</option>
              </select>
              <div style="color:red" class="m-1 form-control-feedback" *ngIf="form.controls['package'].hasError('required') && form.controls['package'].touched">package is required.</div>
            </div>
            <div class=" form-group">
              <label>Is Wireless</label>
              <select class="form-control" [formControl]="form.controls['is_wireless']">
                <option value="Yes">Yes</option>
                <option value="No" [selected]="true">No</option>
              </select>
            </div>
            <div class="form-group">
              <label>Latitude</label>
              <input type="text" placeholder="lat" class="form-control" [formControl]="form.controls['lat']" />

            </div>
            <div class=" form-group">
              <label>Longitude</label>
              <input type="text" placeholder="lag" class="form-control" [formControl]="form.controls['lag']" />
            </div>
            <div class="form-group">
              <label>Router of</label>
              <select class="form-control" [formControl]="form.controls['router_of']">
                <option value="0">Customer</option>
                <option value="1" [selected]="true">Company</option>
              </select>

            </div>

            <div class="form-group">
              <!-- <label>Router Brand</label>
              <select class="form-control" [formControl]="form.controls['routerBrand']">
                <option value="Cisco" [selected]="true">Cisco</option>
                <option value="JQ">JQ</option>

              </select> -->
              <label>Router Brand</label>
              <input type="text" placeholder="Router Brand" class="form-control" [formControl]="form.controls['router_brand']" [ngClass]="{'form-control-danger': form.controls['router_brand'].hasError('required')  && form.controls['router_brand'].touched}"
              />
              <div style="color:red" class="m-1 form-control-feedback" *ngIf="form.controls['router_brand'].hasError('required') && form.controls['router_brand'].touched">router brand is required.</div>

            </div>


            <div class="  form-group">
              <!-- <label>Router Model</label>
              <select class="form-control" [formControl]="form.controls['routerModel']">
                <option value="R28" [selected]="true">R28</option>
                <option value="R30">R30</option>
              </select> -->
              <label>Router Model</label>
              <input type="text" placeholder="Router Model" class="form-control" [formControl]="form.controls['router_model']" [ngClass]="{'form-control-danger': form.controls['router_model'].hasError('required')  && form.controls['router_model'].touched}"
              />
              <div style="color:red" class="m-1 form-control-feedback" *ngIf="form.controls['router_model'].hasError('required') && form.controls['router_model'].touched">router brand is required.</div>

            </div>
            <div class="form-group">
              <label>Router Price</label>
              <input type="number" placeholder="Router Price" [formControl]="form.controls['router_price']" class="form-control" />
            </div>
            <div class=" form-group">
              <label>DropWire of</label>
              <select class="form-control" [formControl]="form.controls['drop_wire_of']">
                <option value="0">Customer</option>
                <option value="1" [selected]="true">Company</option>
              </select>
            </div>
            <div class=" form-group">
              <label>DropWire Meter</label>
              <input type="number" placeholder="DropWire Meter" [formControl]="form.controls['drop_wire_length']" class="form-control"
              />
            </div>
            <div class=" form-group" *ngIf="form.value.drop_wire_of != 'Customer'">
              <label>DropWire Price/Meter</label>
              <input type="number" placeholder="DropWire Price /Meter" [formControl]="form.controls['price_per_meter']" class="form-control"
              />
            </div>

            <div *ngIf="btnSave" class=" form-group">
              <label>Connection Address</label>
              <textarea rows="4" placeholder="Connection Address" class="form-control" [formControl]="form.controls['address']" [ngClass]="{'form-control-danger': form.controls['address'].hasError('required') && form.controls['address'].touched}"></textarea>
              <div style="color:red" class="m-1 form-control-feedback" *ngIf="form.controls['address'].hasError('required') && form.controls['address'].touched">address is required.</div>
            </div>
          </nb-card-body>
        </nb-card>
        <div class="float-right">
          <button *ngIf="!btnSave" type="submit" [disabled]="!form.valid" class="btn btn-primary btn-md">Save</button>
          <button *ngIf="btnSave" type="submit" [disabled]="!disableUpdate" class="btn btn-primary btn-md">Update</button>

        </div>
      </div>

      <div *ngIf="btnSave" class="col-lg-6">

        <ul class="timeline timeline-split">

          <li class="timeline-item period">
            <div class="timeline-info"></div>
            <div class="timeline-marker"></div>
            <div class="timeline-content" style="padding-left: 0;">
              <h2 class="timeline-title nb-card-header">Timeline </h2>
            </div>
          </li>

          <li *ngFor="let package of timeline" class="timeline-item">
            <div class="timeline-info ">
              <span>{{package?.activation_date |date:'MMMM d ,yyyy'}} </span>
            </div>
            <div class="timeline-marker"></div>
            <div class="timeline-content">
              <h3 class="timeline-title nb-card-header">{{package?.package}} </h3>

              <p>Price: {{package?.renewal_price}} </p>

              <p>Status: {{package?.status}} </p>
            </div>
          </li>
          <li class="timeline-item period"></li>


        </ul>

      </div>

    </div>
  </fieldset>
</form>